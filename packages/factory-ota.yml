---
ota:
  - platform: http_request
    id: ota_http_request

http_request:
  buffer_size_rx: 1024
  buffer_size_tx: 1024

update:
  - platform: http_request
    name: Firmware
    id: update_http_request
    source: https://github.com/vt-vaio/rowi2/releases/download/stable/manifest.json

switch:
  - platform: template
    id: dev_firmware
    name: Use dev firmware
    icon: "mdi:test-tube"
    disabled_by_default: true
    entity_category: config
    optimistic: true
    restore_mode: RESTORE_DEFAULT_OFF
    on_turn_on:
      - logger.log:
          format: "OTA updates set to use Beta firmware"
          level: INFO
      - lambda: id(update_http_request).set_source_url("https://github.com/vt-vaio/rowi2/releases/download/latest-dev/manifest.json");
      - component.update: update_http_request
    on_turn_off:
      - logger.log:
          format: "OTA updates set to use Production firmware"
          level: INFO
      - lambda: id(update_http_request).set_source_url("https://github.com/vt-vaio/rowi2/releases/download/stable/manifest.json");
      - component.update: update_http_request
